<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Family Registry</title>

  <script src="api.js"></script>
  <script src="https://accounts.google.com/gsi/client"></script>
  <script src="jwt-decode.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <load>
    <img id="logo" src="logo.png" alt="" />
    <img id="login" onclick="signin()" src="google-signin.png" alt="" />
  </load>

  <main>
    <search class="main">
      <div class="search-container">
        <input type="text" id="search" placeholder="Search names..." oninput="renderTable()" />
      </div>
      <button id="create-person" class="hidden">Add New Person</button>
      <div class="table" id="table">
        <!-- Table rows inserted by JS -->
      </div>
    </search>
    <div id="profile" class="main out">
      <h1 id="name">Matthias</h1>
      <fieldset>
        <legend>Gender</legend>
        <div id="gender"></div>
      </fieldset>
      <fieldset>
        <legend>Phone</legend>
        <div id="phone"></div>
      </fieldset>
      <fieldset>
        <legend>Email</legend>
        <div id="email"></div>
      </fieldset>
      <fieldset>
        <legend>Address</legend>
        <div id="address"></div>
      </fieldset>
      <fieldset>
        <legend>Age</legend>
        <div id="age"></div>
      </fieldset>
      <fieldset>
        <legend>Birthday</legend>
        <div id="bday"></div>
      </fieldset>
      <fieldset>
        <legend>Death Date</legend>
        <div id="dday"></div>
      </fieldset>
      <fieldset>
        <legend>Maiden Name</legend>
        <div id="mname"></div>
      </fieldset>
      <fieldset>
        <legend>Parents</legend>
        <div id="parents"></div>
      </fieldset>
      <fieldset>
        <legend>Spouse</legend>
        <div id="spouse"></div>
      </fieldset>
      <fieldset>
        <legend>Children</legend>
        <div id="children"></div>
      </fieldset>
      <button id="edit-btn" style="display: none;">Edit</button>
      <button id="submit-btn" style="display: none;">Submit</button>
      <button id="cancel-btn" style="display: none;">Cancel</button>
    </div>

    <div id="tree" class="main out">
      <select name="Family" id="tree-family-select"></select>
      <canvas id="tree_display"></canvas>
    </div>

    <div id="calendar" class="main out">
      <span onclick="prevMonth()">◀</span>
      <h3 id="monthlabel"></h3>
      <span onclick="nextMonth()">▶</span>
      <div id="month"></div>
    </div>

    <div id="settings" class="main out">
      <h1>Settings</h1>
      <div>
        <h3>My Families</h3>
        <div id="my-families"></div>
      </div>
      <div>
        <button onclick="logout()">Logout</button>
      </div>
    </div>

    <div id="filters" class="main out">
      <h1>Filters</h1>
      <div class="filters-container">
        <div class="filter-section">
          <h3>Descendants of</h3>
          <div class="descendant-filter">
            <input type="text" id="filter-descendant-search" placeholder="Search person..." />
            <input type="hidden" id="filter-descendant-id" />
            <span id="filter-descendant-name"></span>
            <button onclick="clearDescendantFilter()" class="clear-btn" style="display:none" id="clear-descendant">✕</button>
          </div>
          <div id="descendant-search-results" class="search-dropdown"></div>
        </div>

        <div class="filter-section">
          <h3>Gender</h3>
          <select id="filter-gender">
            <option value="">All</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
        </div>

        <div class="filter-section">
          <h3>Status</h3>
          <select id="filter-status">
            <option value="">All</option>
            <option value="alive">Living</option>
            <option value="deceased">Deceased</option>
          </select>
        </div>

        <div class="filter-section">
          <h3>Age Range</h3>
          <div class="age-range">
            <input type="number" id="filter-age-min" placeholder="Min" min="0" max="150" />
            <span>to</span>
            <input type="number" id="filter-age-max" placeholder="Max" min="0" max="150" />
          </div>
        </div>

        <div class="filter-section">
          <h3>Has Birthday</h3>
          <select id="filter-has-birthday">
            <option value="">All</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </div>

        <div class="filter-actions">
          <button onclick="applyFilters()">Apply Filters</button>
          <button onclick="clearFilters()" class="secondary-btn">Clear Filters</button>
        </div>
      </div>

      <div class="filter-results">
        <h3>Results: <span id="filter-count">0</span> people</h3>
        <div class="table" id="filter-table">
          <!-- Filtered results inserted by JS -->
        </div>
      </div>

      <div class="export-section">
        <h3>Export</h3>
        <button onclick="exportToCSV()">Export to CSV</button>
      </div>
    </div>

    <div id="person_select_modal" class="hidden"></div>

    <div id="add_person" class="hidden">
      <h1>Add Person</h1>
      <fieldset>
        <legend>Name</legend>
        <input type="text" id="name-input" />
        <select id="family-id"></select>
        <button id="new-person-submit">Submit</button>
        <button id="new-person-cancel">Cancel</button>
      </fieldset>
    </div>
  </main>

  <footer>
    <img onclick="gotoSearch()" id="search" src="search.png" alt="" />
    <img onclick="gotoTree()" src="tree.png" alt="" />
    <img onclick="gotoCalendar()" id="calendar-icon" src="calendar.png" alt="" />
    <img onclick="gotoFilters()" src="filter.png" alt="" />
    <img onclick="gotoSettings()" src="settings.png" alt="" />
  </footer>

  <script src="main.js"></script>
  <script src="input.js"></script>
  <script src="tree.js"></script>
</body>

</html>